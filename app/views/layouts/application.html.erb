<!doctype html>
<html class="container-fluid p-0" lang="en">
  <head>
    <title>Agora</title>
    <!-- Required JS for Destroy handling and such -->
    <%= csrf_meta_tags %>
    <%= javascript_include_tag "application" %>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Google Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link href="https://use.fontawesome.com/releases/v5.0.1/css/all.css" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <%= stylesheet_link_tag "application" %>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <!-- tinyMCE assets --> 
    <%= tinymce_assets %>
    <script type="text/javascript" src="/assets/tinymce.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Vollkorn" rel="stylesheet">
  </head>
  
  <script>
    $(document).on('turbolinks:load', function() {
      
      if ($(window).width() >= 768) {
        $('#hero').css('visibility', 'visible');
        $('.jumbotron-bg').fadeIn(100);
        $('.jumbotron-overlay').fadeIn(100);
        $('.jumbotron').fadeIn(100);
        $('#categories').fadeIn(100);
      } else {
        $('#hero').hide();
        $('#hero-mobile').show();
      }
      
      var jumboHeight = $('.jumbotron').outerHeight();
      function parallax(){
          var scrolled = $(window).scrollTop();
          $('.jumbotron-bg').css('height', (jumboHeight-scrolled) + 'px');
          $('.jumbotron-overlay').css('height', (jumboHeight-scrolled) + 'px');
      }
      
      $(window).scroll(function(e){
          parallax();
      });
    });
  </script>
  <% if current_page?(root_path) %>
    <% Article.offset(3).first(1).each do |article| %>
    <div id="hero" style="visibility: hidden; height: 500px">
      <div class="jumbotron-bg" style="background: url(<%= article.thumbnail.url(:large) %>) no-repeat center center; background-size: cover; display: none"></div>
      <div class="jumbotron-overlay" style="display: none"></div>
      <div class="jumbotron jumbotron-fluid jumbotron-main mb-0 pb-0" style="display: none">
        <div class="container" style="max-width: 1400px">
          <h1 class="display-4">DISCOVER</h1>
          <hr class="my-2" style="border-color: white">
          <%= link_to article_path(article), class: "card-link" do %>
            <span class="article-title" style="color: white"><%= article.title %></span>
            <div class="d-flex">
              <span class="article-subtitle" style="color: white"><%= article.sub_title %></span>
              &nbsp<%= link_to "Read", article_path(article), class:"btn btn-sm btn-outline-light" %>
            </div>
          <% end %>
          <br>
        </div>
      </div>
      <span id="categories" style="position: relative; top:-80px; display: none"><%= render 'home/categories_jumbotron' %></span>
    </div>
    <% end %>
    <div id="hero-mobile" style="position: relative; top:60px; display: none">
      <%= render 'home/categories_mobile' %>
    </div>
  <% end %>
  
  <body data-spy="scroll">
    <%= render 'layouts/navbar' %>
    <div class="container text-center" style="max-width:800px">
      <% if flash[:notice] %>
        <%= content_tag :div, class: "alert alert-success" do %>
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <%= notice %>
        <% end %>
      <% end %>
      <% if flash[:alert] %>
        <%= content_tag :div, class: "alert alert-danger" do %>
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <%= alert %>
        <% end %>
      <% end %>
    </div>
  
    <%= yield %>
  
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2.1/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dragscroll/0.0.8/dragscroll.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
        $('[data-toggle="tooltip"]').tooltip();   
      });
</script>
  </body>
  
  <footer>(Footer)</footer>
  
</html>