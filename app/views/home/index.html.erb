<body>
  
<% if user_signed_in? %>

<h2>Your Articles</h2>

<div class="card-columns">
  <% @articles.each do |article| %>
    <% if article.user_id == current_user.id %>
      <div class="card">
        <img class="card-img-top" src="//placehold.it/720x350" alt="Card image cap">
          <figure class="profile">
            <img src="" class="profile-avatar" alt="">
          </figure>
        <div class="card-body">
          <h4 class="card-title"><%= article.title %></h4>
          <h6 class="card-subtitle mb-2 text-muted"><%= article.author %></h6>
          <h6 class="card-subtitle mb-2 text-muted"><%= article.author_work_place %></h6>
        </div>
        <div class="card-footer bg-transparent">
          <small class="text-muted">Published on <%= article.created_at.strftime("%b %d") %></small>
          <%= link_to "Read", article_path(article), class: "btn btn-dark float-right btn-sm" %>
        </div>
        
      </div>
    <% end %>
  <% end %>
  </div>
<% end %>

    
<br><br />

<h2>Latest Articles</h2>

<div class="card-deck">
  
  <% @articles.each do |article| %>
  
    <div class="card" style="min-width: 400px; margin-bottom: 30px">
      <img class="card-img-middle img-fluid" src="//placehold.it/720x350" alt="Card image cap">
      <div class="card-body">
        <small><%#= link_to Category.find(article.category_id).name, category_path(article.category_id) %></small> 
        <%= link_to article_path(article), class: "card-link" do %>
          <strong class="d-flex card-title"><%= article.title %></strong>
          <small class="d-flex card-subtitle"><%= article.sub_title %></small>
        <% end %>
      </div>
      
      <div class="card-body pt-0 pb-2">  
        <div class="d-flex justify-content-between align-items-center">
          <small class="text-muted align-middle">Published on <%= article.created_at.strftime("%b %d") %></small>
          <div class="bookmarking">
            <% if user_signed_in? %>
              <% if current_user.liked? article %>
                <%= button_to "Unbookmark", unbookmark_article_path(article), remote: true, id: "unlike_#{article.id}", method: :put, class: "btn btn-danger btn-sm" %>
              <% else %>
                <%= button_to "Bookmark", bookmark_article_path(article), remote: true, id: "like_#{article.id}", method: :put, class: "btn btn-primary btn-sm" %>
              <% end %>
            <% end %>
          </div> 
        </div>
      </div>
      
      <div class="card-footer bg-transparent">
        
        <div class="d-flex flex-row">
          <% author_avatar = User.find(article.user_id) %>
          <% if author_avatar.avatar != nil %>
          <div >
            <%= image_tag(author_avatar.avatar.url(:thumb), class:"rounded-circle border border-secondary", style: "height: 60px; width: 60px;") %>
          </div>
          <% end %>
          <div class="p-2">
            <h6 class="card-subtitle mb-2 text-muted"><%= article.author %></h6>
            <p class="card-subtitle mb-2 text-muted"><%= article.author_work_place %></p>
          </div>
        </div>
        <!--Bookmarked <%#= article.votes_for.size.to_s %> times-->
      </div>
    </div>
  <% end %>
</div>

</body>
</html>

<%#= link_to "UBM",  bookmark,  method: :delete, id: bookmark.id, data: { confirm: 'Are you sure?', remote: true }, class: "btn btn-danger btn-sm", role: "button" %> 
<%# if Bookmark.find_by(:user_id => current_user.id, :article_id => article.id) == nil %>
<%#= link_to "BM", bookmarks_path(:user_id => current_user.id, :article_id => article.id), :method => :post, class: "btn btn-primary btn-sm", role: "button" %>
